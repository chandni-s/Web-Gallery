# A3: API Documentation

## The Web Gallery

Note: The delete functionality works, except it doesn't refresh. Hence the user needs to click on another username
The navigating image feature is under progress.
Apologies for designing/styling - the focus of this app was full stack backend functionality
The server certificate and key are private. Please email at c.sehgal12@gmail.com to discuss further.

### Create

- description: Sign up
- request: `PUT /signup/`
    - content-type: `application/json`
    - body: object
      - username: (string) username of image (can only be alphabetic characters)
      - password: (string) password for their account
- response:
    - content-type: `application/json`
    - body: object
      - username: (string) username signed up
      - _id: (string) the id of user generated by database
- response: 500
    - body: Database error
- response: 409
    - body: Username already exists


```
curl -k -X PUT -H "Content-Type: application/json" -d '{"username":"cat","password":"1"}' --cookie-jar ./cookieFile http://localhost:3000/api/signup/
```

- description: Sign In
- request: `POST /signin/`
  - content-type: `application/json`
  - body: object
    - username: (string) username for gallery account
    - password: (string) password used to sign up for this account
- response:
    - content-type: `application/json`
    - body: object
      - username: (string) username for gallery
      - _id: (string) id of user when they signed up

- response: 400
    - body: Please enter username and password to sign in
- response: 500
    - body: Database error
- response: 401
    - body: Unauthorized


```
curl -k -X POST -H "Content-Type: application/json" -d '{"username":"alice","password":"1"}' --cookie-jar ./cookieFile https://localhost:3000/signin/

curl -X POST -d '{"username":"alice","password":"1"}' -c cookie.txt http://localhost:3000/signin/

curl -k -X POST -H "Content-Type: application/json" -d '{"username":"yokks","pass":"1"}' --cookie-jar ./cookieFile http://localhost:3000/api/signin/

curl -b -k -X PUT -H "Content-Type: application/json" -d '{"username":"yokks","pass":"1"}' --cookie-jar cookieFile http://localhost:3000/api/signup/

curl -X POST -d "username=mallory&password=pass4admin" -c cookie.txt http://localhost:3000/signin/
```

- description: upload an image
- request: `POST /users/`
    - content-type: `application/json`
    - body: object
      - title: (string) the title of the image
      - author: (string) the authors of the image
      - url: (string) the http or file upload path of the image
- response: 200
    - content-type: `application/json`
    - body: object
      - username: (string) the username who uploaded this image
      - _id: (string) the image id
      - title: (string) the title of the image
      - author: (string) the authors username
      - url: (string) the path/link to image
      - createAt: (Date) the creation time of this object
      - updatedAt: (Date) update time of the image object

- response: 500
    - body: Database error

```
$ curl -k -X POST -H "Content-Type: application/json" -d '{"title":"<h1>Picture</h1>","author":"chani", "url":"http://r.ddmcdn.com/s_f/o_1/cx_633/cy_0/cw_1725/ch_1725/w_720/APL/uploads/2014/11/too-cute-doggone-it-video-playlist.jpg"}' --cookie ./cookieFile https://localhost:3000/users/


curl -k -X POST -H "Content-Type: application/json" -d '{"name":"tagname","username":"chani"}' --cookie ./cookieFile https://localhost:3000/api/addtrend/
```

- description: create a comment for an image
- request: `POST /images/:imgID/comments/`
  - content-type: `application/JSON`
  - body: object
    - authorName: (string) the name of author writing the comment
    - comment: (string) the comment for the image
- response: 200
  - content-type: `application/json`
  - body: object
    - username: (string) username of user who posted comment on image
    - imageid: (string) id of image on which the comment is posted
    - _id: (string) id of this comment created
    - date: (Date) the date of this comment
    - authorName: (string) the name of authorName
    - comment: (string) the comment made by author
    - createAt: (Date) the creation time of this comment
    - updatedAt: (Date) update time of this comment

- response: 403
    - body: Forbidden
- response: 500
    - body: Database error

```
$ curl -k -X POST -H "Content-Type: application/json" -d '{"authorName":"a","comment":"a"}' --cookie ./cookieFile https://localhost:3000/users/alice/5wLh8fEL6uaYBnYB/comments/
```

### Read

- description: sign the user out of their gallery and destroy their current session
- request: `GET /signout/`
- response:
- response: 500
    -body: Database error

```
curl -k -X GET --cookie ./cookieFile https://localhost:3000/signout/
```

- description: get ALL Users to display paginated gallery
- request: `GET /users/`   
- response: 200
    - content-type: `application/json`
    - body: list of username objects
      - username: (string) the username of signed up users
      - _id: (string) the id of signed up users
      - createAt: (Date) the creation time of this object
      - updatedAt: (Date) update time of the image object

- response: 403
    - body: Forbidden
- response: 500
    - body: Database error

```
$ curl -k -X GET --cookie ./cookieFile https://localhost:3000/users/
```

- description: get an image of the user selected (and any associated comment with image, if any)
- request: `GET /users/:username/images/`
- response: 200
  - content-type: `application/json`
  - body: object
    - username: (string) the name of user who uploaded the image (gallery owner)
    - title: (string) title of image
    - author: (string) author of image
    - url: (string) the path (http or file) of the image
    - createAt: (Date) the creation time of this object
    - updatedAt: (Date) the update time of this object

- response: 403
    - body: Forbidden
- response: 404
    - body: Images for this user not found

```
$ curl -k -X GET --cookie ./cookieFile https://localhost:3000/users/alice/images/
```

- description: get comments for image currently displayed to user
- request: `GET /users/:username/images/:image/comments/`
- response: 200
  - content-type: `application/json`
  - body: list of objects
    - username: (string) the user who posted this comment
    - imageid: (string) the id of image on which this comment is posted
    - authorName: (string) the author of this comment
    - comment: (string) the content of the comment
    - _id: (string) the id of this comment object
    - createAt: (Date) the creation time of this object
    - updatedAt: (Date) the update time of this object

- response: 403
    - body: Forbidden
- response: 404
    - body: Comments for image not found

```
$ curl -k -X GET --cookie ./cookieFile https://localhost:3000/users/alice/images/5wLh8fEL6uaYBnYB/comments/
```

### Delete

- description: delete a comment of an image
- request: `DELETE /users/:username/images/:image/comments/:commentid/`
- response: 200
- response: 403
    - body: Forbidden
- response: 401
    - body: Unauthorized
- response: 404
    - body: comment id does not exist

```
$ curl -k -X DELETE --cookie ./cookieFile https://localhost:3000/users/alice/images/5wLh8fEL6uaYBnYB/comments/Nwo81qW6rVmyXJjX/
```

- description: delete image and comments pertaining to it (if any)
- request: `DELETE /users/:username/images/:image/`
- response: 200
- response: 403
    - body: Forbidden
- response: 401
    - body: Unauthorized
- response: 404
    - body: image id does not exist

```
$ curl -k -X DELETE --cookie ./cookieFile https://localhost:3000/users/alice/images/5wLh8fEL6uaYBnYB/
```
